# NetFlow监控系统 - 排序功能说明

## 功能概述

NetFlow监控系统现已支持对会话列表和IP统计表格进行多字段排序，提供更灵活的数据分析体验。

## 排序功能特性

### 🔄 双向排序
- **升序排列** (ASC): 从小到大排序
- **降序排列** (DESC): 从大到小排序
- 点击表头可在升序和降序之间切换

### 📊 支持的排序字段

#### 会话列表排序
- **源IP地址** (`src_ip`) - 按IP地址字母顺序排序
- **目标IP地址** (`dst_ip`) - 按IP地址字母顺序排序  
- **协议类型** (`protocol`) - 按TCP/UDP/ICMP排序
- **会话状态** (`state`) - 按ACTIVE/EXPIRED状态排序
- **总数据包** (`total_packets`) - 按数据包数量排序
- **总流量** (`total_bytes`) - 按流量大小排序 ⭐
- **持续时间** (`duration`) - 按会话持续时间排序
- **最后活跃** (`last_seen`) - 按最后活跃时间排序 🔄(默认)

#### IP统计排序
- **IP地址** (`ip`) - 按IP地址字母顺序排序
- **发送流量** (`bytes_sent`) - 按发送字节数排序
- **接收流量** (`bytes_received`) - 按接收字节数排序
- **总流量** (`total_bytes`) - 按总流量大小排序 ⭐(默认)
- **会话数量** (`session_count`) - 按关联会话数排序

## 🎯 使用方法

### 1. 表头点击排序
- 点击任意带有 ▲▼ 图标的表头进行排序
- 首次点击：按该字段降序排列
- 再次点击：切换为升序排列
- 点击其他字段：切换排序字段

### 2. 排序状态指示
- **激活的排序字段**: 图标显示为白色且清晰
- **非激活字段**: 图标显示为半透明
- **▼ 图标**: 当前为降序排列
- **▲ 图标**: 当前为升序排列

### 3. 默认排序
- **会话列表**: 默认按"最后活跃"时间降序排列（最新的在前）
- **IP统计**: 默认按"总流量"降序排列（流量最大的在前）

## 🔧 技术实现

### 后端API增强
```
GET /api/sessions?order_by=total_bytes&order_direction=desc
GET /api/ip-stats?order_by=session_count&order_direction=asc
```

### 支持的API参数
- `order_by`: 排序字段名称
- `order_direction`: 排序方向 (asc/desc)

### 前端交互
- 响应式排序图标 (▲▼)
- 实时状态更新
- 平滑的用户体验

## 📈 使用场景

### 流量分析
1. **按总流量排序** - 快速找出流量最大的IP或会话
2. **按数据包数排序** - 识别高频通信的连接
3. **按会话数排序** - 发现活跃度最高的IP地址

### 安全监控
1. **按最后活跃时间排序** - 监控最近的网络活动
2. **按持续时间排序** - 发现长时间连接的异常会话
3. **按协议类型排序** - 分析不同协议的使用情况

### 网络优化
1. **按发送/接收流量排序** - 分析流量方向和模式
2. **按IP地址排序** - 按网段分析网络使用情况

## 🎨 视觉效果

### 排序图标样式
- 鼠标悬停: 表头背景变亮，提示可点击
- 激活状态: 排序图标高亮显示
- 方向指示: 清晰的上下箭头指示排序方向

### 表格优化
- 保持响应式设计
- 排序过程中数据平滑更新
- 保持原有的颜色和样式主题

## ✅ 测试验证

### 功能测试
- ✅ 会话列表多字段排序正常
- ✅ IP统计表格排序正常
- ✅ 升序/降序切换正常
- ✅ 排序图标状态正确
- ✅ API参数传递正确

### 兼容性
- ✅ 与现有功能无冲突
- ✅ 实时数据更新不受影响
- ✅ 地理位置信息正常显示
- ✅ 响应式布局保持正常

## 🚀 性能优化

### 后端优化
- 数据库级别排序，减少内存占用
- 支持索引优化的常用排序字段
- 合理的SQL查询优化

### 前端优化
- 最小化DOM操作
- 异步数据加载
- 平滑的用户交互体验

---

**NetFlow监控系统排序功能现已全面启用！**

*通过点击表头轻松排序，让数据分析更加高效便捷。*